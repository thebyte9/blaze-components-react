(self.webpackChunkblaze_react=self.webpackChunkblaze_react||[]).push([[518],{52518:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:function(){return stories_DemoComponent}});__webpack_require__(68309),__webpack_require__(12419);var classCallCheck=__webpack_require__(6610),createClass=__webpack_require__(5991),inherits=__webpack_require__(10379),possibleConstructorReturn=__webpack_require__(86089),getPrototypeOf=__webpack_require__(77608),src=(__webpack_require__(19601),__webpack_require__(54747),__webpack_require__(47941),__webpack_require__(47042),__webpack_require__(21249),__webpack_require__(41539),__webpack_require__(39714),__webpack_require__(56959)),immutability_helper=__webpack_require__(7145),immutability_helper_default=__webpack_require__.n(immutability_helper),react=__webpack_require__(67294),react_addons_shallow_compare=__webpack_require__(1775),react_addons_shallow_compare_default=__webpack_require__.n(react_addons_shallow_compare),src_DragLayer=function DragLayer(_ref){var dragItem=_ref.dragItem,children=_ref.children,dragLayerRef=_ref.dragLayerRef,el=document.getElementById(dragItem.id);return react.createElement("div",{className:"nestable-drag-layer"},react.createElement("ol",{className:"nestable-list",ref:dragLayerRef,style:{width:el.clientWidth}},children))},src_DragHandler=function DragHandler(_ref){var onDragStart=_ref.onDragStart;return react.createElement("div",{className:"list__drag",onDragStart:onDragStart,draggable:!0,"data-testid":"drag-handler"},react.createElement("i",{className:"material-icons"},"drag_indicator"))},NestableItem=function NestableItem(_ref){var item=_ref.item,isCopy=_ref.isCopy,index=_ref.index,_onMouseEnter=_ref.onMouseEnter,_onDragStart=_ref.onDragStart,dragItem=_ref.dragItem,RenderItem=_ref.renderItem,childrenProp=_ref.childrenProp,isDragging=!isCopy&&dragItem&&dragItem.id===item.id,hasChildrenProperty=item[childrenProp],hasChildren=item[childrenProp]&&item[childrenProp].length,listItemClassName=(0,src.g2)("nestable-item"+(isCopy?"-copy":""),{"is-dragging":isDragging,"nestable-item-parent":hasChildrenProperty});return react.createElement("li",{className:listItemClassName,id:item.id,"data-testid":"nestable-item-"+index},react.createElement("div",{className:"nestable-item-name",onMouseEnter:function onMouseEnter(e){return _onMouseEnter(e,item)}},react.createElement(RenderItem,{item:item,index:index,DragHandler:function DragHandler(){return react.createElement(src_DragHandler,{onDragStart:function onDragStart(e){return _onDragStart(e,item)}})}},hasChildrenProperty&&hasChildren?react.createElement("ol",{className:"nestable-list"},item[childrenProp].map((function(element,i){return react.createElement(NestableItem,{key:element.id,index:i,item:element,isCopy:isCopy,dragItem:dragItem,renderItem:RenderItem,childrenProp:childrenProp,onMouseEnter:_onMouseEnter,onDragStart:_onDragStart})}))):null)))};NestableItem.defaultProps={dragItem:null,isCopy:!1};var src_NestableItem=NestableItem;function getItemByPath(_ref){var path=_ref.path,items=_ref.items,childrenProp=_ref.childrenProp,item=null;return path.forEach((function(index){var list=item?item[childrenProp]:items;item=list[index]})),item}try{getItemByPath.displayName="getItemByPath",getItemByPath.__docgenInfo={description:"",displayName:"getItemByPath",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/Dnd/src/utils/getItemByPath.ts#getItemByPath"]={docgenInfo:getItemByPath.__docgenInfo,name:"getItemByPath",path:"packages/Dnd/src/utils/getItemByPath.ts#getItemByPath"})}catch(__react_docgen_typescript_loader_error){}__webpack_require__(92222);var getPathById=function getPathById(_ref){var id=_ref.id,items=_ref.items,childrenProp=_ref.childrenProp,path=[];return items.forEach((function(item,index){if(item.id===id)path.push(index);else if(item[childrenProp]){var childrenPath=getPathById({childrenProp:childrenProp,id:id,items:item[childrenProp]});childrenPath.length&&(path=path.concat(index).concat(childrenPath))}})),path};try{getPathById.displayName="getPathById",getPathById.__docgenInfo={description:"",displayName:"getPathById",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/Dnd/src/utils/getPathById.ts#getPathById"]={docgenInfo:getPathById.__docgenInfo,name:"getPathById",path:"packages/Dnd/src/utils/getPathById.ts#getPathById"})}catch(__react_docgen_typescript_loader_error){}var getRealNextPath=function getRealNextPath(_ref){var prevPath=_ref.prevPath,nextPath=_ref.nextPath,items=_ref.items,childrenProp=_ref.childrenProp,prevPathLastIndex=prevPath.length-1,nextPathLastIndex=nextPath.length-1;if(prevPath.length<nextPath.length){var wasShifted=!1;return nextPath.map((function(nextElement,index){return wasShifted?index===nextPathLastIndex?nextElement+1:nextElement:"number"!=typeof prevPath[index]?nextElement:nextPath[index]>prevPath[index]&&index===prevPathLastIndex?(wasShifted=!0,nextElement-1):nextElement}))}if(prevPath.length===nextPath.length&&nextPath[nextPathLastIndex]>prevPath[nextPathLastIndex]){var target=getItemByPath({childrenProp:childrenProp,items:items,path:nextPath});if(target[childrenProp]&&target[childrenProp].length)return nextPath.slice(0,-1).concat(nextPath[nextPathLastIndex]-1).concat(0)}return nextPath};try{getRealNextPath.displayName="getRealNextPath",getRealNextPath.__docgenInfo={description:"",displayName:"getRealNextPath",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/Dnd/src/utils/getRealNextPath.ts#getRealNextPath"]={docgenInfo:getRealNextPath.__docgenInfo,name:"getRealNextPath",path:"packages/Dnd/src/utils/getRealNextPath.ts#getRealNextPath"})}catch(__react_docgen_typescript_loader_error){}var toConsumableArray=__webpack_require__(85061),getSplicePath=function getSplicePath(path){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},splicePath={},numToRemove=options.numToRemove||0,itemsToInsert=options.itemsToInsert||[],lastIndex=path.length-1,currentPath=splicePath;return path.forEach((function(element,index){if(index===lastIndex)currentPath.$splice=[[element,numToRemove].concat((0,toConsumableArray.Z)(itemsToInsert))];else{var _currentPath$element,nextPath={};currentPath[element]=((_currentPath$element={})[options.childrenProp]=nextPath,_currentPath$element),currentPath=nextPath}})),splicePath},index_prod=__webpack_require__(18917),listWithChildren=function listWithChildren(list,childrenProp){return list.map((function(item){var _Object$assign;return Object.assign(Object.assign({},item),((_Object$assign={id:item.id||(0,index_prod.x0)()})[childrenProp]=item[childrenProp]?listWithChildren(item[childrenProp],childrenProp):null,_Object$assign))}))},tryDecreaseDepth=function tryDecreaseDepth(_ref){var dragItem=_ref.dragItem,items=_ref.items,childrenProp=_ref.childrenProp,pathFrom=getPathById({childrenProp:childrenProp,id:dragItem.id,items:items}),itemIndex=pathFrom[pathFrom.length-1];if(pathFrom.length>1&&itemIndex+1===getItemByPath({childrenProp:childrenProp,items:items,path:pathFrom.slice(0,-1)})[childrenProp].length){var pathTo=pathFrom.slice(0,-1);return pathTo[pathTo.length-1]+=1,{dragItem:dragItem,pathFrom:pathFrom,pathTo:pathTo}}};try{tryDecreaseDepth.displayName="tryDecreaseDepth",tryDecreaseDepth.__docgenInfo={description:"",displayName:"tryDecreaseDepth",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/Dnd/src/utils/tryDecreaseDepth.ts#tryDecreaseDepth"]={docgenInfo:tryDecreaseDepth.__docgenInfo,name:"tryDecreaseDepth",path:"packages/Dnd/src/utils/tryDecreaseDepth.ts#tryDecreaseDepth"})}catch(__react_docgen_typescript_loader_error){}var tryIncreaseDepth=function tryIncreaseDepth(_ref){var dragItem=_ref.dragItem,items=_ref.items,childrenProp=_ref.childrenProp;if(dragItem){var pathFrom=getPathById({childrenProp:childrenProp,id:dragItem.id,items:items}),itemIndex=pathFrom[pathFrom.length-1];if(itemIndex>0){var prevSibling=getItemByPath({childrenProp:childrenProp,items:items,path:pathFrom.slice(0,-1).concat(itemIndex-1)});if(prevSibling[childrenProp]&&!prevSibling[childrenProp].length){var pathTo=pathFrom.slice(0,-1).concat(itemIndex-1).concat(prevSibling[childrenProp].length);return{dragItem:dragItem,pathFrom:pathFrom,pathTo:pathTo}}}}};try{tryIncreaseDepth.displayName="tryIncreaseDepth",tryIncreaseDepth.__docgenInfo={description:"",displayName:"tryIncreaseDepth",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/Dnd/src/utils/tryIncreaseDepth.ts#tryIncreaseDepth"]={docgenInfo:tryIncreaseDepth.__docgenInfo,name:"tryIncreaseDepth",path:"packages/Dnd/src/utils/tryIncreaseDepth.ts#tryIncreaseDepth"})}catch(__react_docgen_typescript_loader_error){}try{getItemByPath.displayName="getItemByPath",getItemByPath.__docgenInfo={description:"",displayName:"getItemByPath",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/Dnd/src/utils/index.ts#getItemByPath"]={docgenInfo:getItemByPath.__docgenInfo,name:"getItemByPath",path:"packages/Dnd/src/utils/index.ts#getItemByPath"})}catch(__react_docgen_typescript_loader_error){}try{getPathById.displayName="getPathById",getPathById.__docgenInfo={description:"",displayName:"getPathById",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/Dnd/src/utils/index.ts#getPathById"]={docgenInfo:getPathById.__docgenInfo,name:"getPathById",path:"packages/Dnd/src/utils/index.ts#getPathById"})}catch(__react_docgen_typescript_loader_error){}try{getRealNextPath.displayName="getRealNextPath",getRealNextPath.__docgenInfo={description:"",displayName:"getRealNextPath",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/Dnd/src/utils/index.ts#getRealNextPath"]={docgenInfo:getRealNextPath.__docgenInfo,name:"getRealNextPath",path:"packages/Dnd/src/utils/index.ts#getRealNextPath"})}catch(__react_docgen_typescript_loader_error){}try{tryDecreaseDepth.displayName="tryDecreaseDepth",tryDecreaseDepth.__docgenInfo={description:"",displayName:"tryDecreaseDepth",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/Dnd/src/utils/index.ts#tryDecreaseDepth"]={docgenInfo:tryDecreaseDepth.__docgenInfo,name:"tryDecreaseDepth",path:"packages/Dnd/src/utils/index.ts#tryDecreaseDepth"})}catch(__react_docgen_typescript_loader_error){}try{tryIncreaseDepth.displayName="tryIncreaseDepth",tryIncreaseDepth.__docgenInfo={description:"",displayName:"tryIncreaseDepth",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/Dnd/src/utils/index.ts#tryIncreaseDepth"]={docgenInfo:tryIncreaseDepth.__docgenInfo,name:"tryIncreaseDepth",path:"packages/Dnd/src/utils/index.ts#tryIncreaseDepth"})}catch(__react_docgen_typescript_loader_error){}function _createSuper(Derived){var hasNativeReflectConstruct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=(0,getPrototypeOf.Z)(Derived);if(hasNativeReflectConstruct){var NewTarget=(0,getPrototypeOf.Z)(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return(0,possibleConstructorReturn.Z)(this,result)}}var Nestable=function(_Component){(0,inherits.Z)(Nestable,_Component);var _super=_createSuper(Nestable);function Nestable(props){var _this;return(0,classCallCheck.Z)(this,Nestable),(_this=_super.call(this,props)).startTrackMouse=function(){document.addEventListener("mousemove",_this.onMouseMove),document.addEventListener("mouseup",_this.onDragEnd)},_this.stopTrackMouse=function(){document.removeEventListener("mousemove",_this.onMouseMove),document.removeEventListener("mouseup",_this.onDragEnd)},_this.onMouseEnter=function(e,item){e.preventDefault(),e.stopPropagation();var _this$state=_this.state,dragItem=_this$state.dragItem,items=_this$state.items,childrenProp=_this.props.childrenProp;if(dragItem&&dragItem.id!==item.id){var pathFrom=getPathById({childrenProp:childrenProp,id:dragItem.id,items:items}),pathTo=getPathById({childrenProp:childrenProp,id:item.id,items:items}),newDragItem=Object.assign(Object.assign({},dragItem),{status:"show"});_this.moveItem({dragItem:newDragItem,pathFrom:pathFrom,pathTo:pathTo})}},_this.onMouseMove=function(e){var childrenProp=_this.props.childrenProp,_this$state2=_this.state,dragItem=_this$state2.dragItem,items=_this$state2.items,clientX=e.clientX,transformProps=function getTransformProps(x,y){return{transform:"translate("+x+"px, "+y+"px)"}}(clientX-30,e.clientY-50),dragLayer=_this.dragLayerRef.current;Object.keys(transformProps).forEach((function(key){Object.prototype.hasOwnProperty.call(transformProps,key)&&dragLayer&&dragLayer.style&&(dragLayer.style[key]=transformProps[key])}));var diffX=clientX-_this.mouse.last.x;if(diffX>=0&&_this.mouse.shift.x>=0||diffX<=0&&_this.mouse.shift.x<=0?_this.mouse.shift.x+=diffX:_this.mouse.shift.x=0,_this.mouse.last.x=clientX,dragItem&&Math.abs(_this.mouse.shift.x)){var movementData={childrenProp:childrenProp,dragItem:dragItem,items:items},availableDrop=_this.mouse.shift.x>0?tryIncreaseDepth(movementData):tryDecreaseDepth(movementData);availableDrop&&_this.moveItem(availableDrop),_this.mouse.shift.x=0}},_this.onDragEnd=function(e){e&&e.preventDefault(),_this.stopTrackMouse(),_this.el=null,_this.dragApply()},_this.onDragStart=function(e,item){e.preventDefault(),e.stopPropagation(),_this.el=function closest(target,selector){for(;target;){if(target.matches&&target.matches(selector))return target;target=target.parentNode}return null}(e.target,".nestable-item-parent"),_this.startTrackMouse(),_this.onMouseMove(e);var newItem=Object.assign(Object.assign({},item),{status:"hide"});_this.setState({dragItem:newItem})},_this.state={dragItem:null,isDirty:!1,items:[]},_this.dragLayerRef=(0,react.createRef)(),_this.el=null,_this.mouse={last:{x:0},shift:{x:0}},_this}return(0,createClass.Z)(Nestable,[{key:"componentDidMount",value:function componentDidMount(){var items=this.props.items,childrenProp=this.props.childrenProp;items=listWithChildren(items,childrenProp),this.setState({items:items})}},{key:"componentDidUpdate",value:function componentDidUpdate(prevProps){var _this$props=this.props,newItems=_this$props.items,childrenProp=_this$props.childrenProp;react_addons_shallow_compare_default()({props:this.props,state:{}},prevProps,{})&&(this.stopTrackMouse(),this.updateProps(newItems,childrenProp))}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.stopTrackMouse()}},{key:"updateProps",value:function updateProps(newItems,childrenProp){this.setState({dragItem:null,isDirty:!1,items:listWithChildren(newItems,childrenProp)})}},{key:"moveItem",value:function moveItem(_ref){var dragItem=_ref.dragItem,pathFrom=_ref.pathFrom,pathTo=_ref.pathTo,_this$props2=this.props,childrenProp=_this$props2.childrenProp,confirmChange=_this$props2.confirmChange,items=this.state.items,realPathTo=getRealNextPath({childrenProp:childrenProp,items:items,nextPath:pathTo,prevPath:pathFrom});if(confirmChange(dragItem,getItemByPath({childrenProp:childrenProp,items:items,path:realPathTo.length>pathTo.length?pathTo:pathTo.slice(0,-1)}))){var removePath=getSplicePath(pathFrom,{childrenProp:childrenProp,numToRemove:1}),insertPath=getSplicePath(realPathTo,{childrenProp:childrenProp,itemsToInsert:[dragItem],numToRemove:0});items=immutability_helper_default()(items,removePath),items=immutability_helper_default()(items,insertPath),this.setState({isDirty:!0,items:items})}}},{key:"resetItems",value:function resetItems(items){var _this2=this;return items.map((function(item){return item.items&&(item.items=_this2.resetItems(item.items)),item.status="show",item}))}},{key:"dragApply",value:function dragApply(){var onChange=this.props.onChange,_this$state3=this.state,items=_this$state3.items,isDirty=_this$state3.isDirty,dragItem=_this$state3.dragItem;this.setState({dragItem:null,isDirty:!1});var newItems=this.resetItems(items);this.setState({items:newItems}),onChange&&isDirty&&onChange(newItems,dragItem)}},{key:"render",value:function render(){var _this3=this,_this$state4=this.state,items=_this$state4.items,dragItem=_this$state4.dragItem,_this$props3=this.props,renderItem=_this$props3.renderItem,childrenProp=_this$props3.childrenProp,wrapperClassName=(0,src.g2)("nestable",{"is-dragging":dragItem});return react.createElement("div",{className:wrapperClassName},react.createElement("ol",{className:"nestable-list nestable-group","data-testid":"nestable-group"},items.map((function(item,index){return react.createElement(src_NestableItem,{dragItem:dragItem,renderItem:renderItem,childrenProp:childrenProp,onMouseEnter:_this3.onMouseEnter,onDragStart:_this3.onDragStart,key:item.id,index:index,item:item})}))),dragItem&&react.createElement(src_DragLayer,{dragLayerRef:this.dragLayerRef,dragItem:dragItem},react.createElement(src_NestableItem,{dragItem:dragItem,renderItem:renderItem,childrenProp:childrenProp,onMouseEnter:this.onMouseEnter,onDragStart:this.onDragStart,item:dragItem,isCopy:!0})))}}]),Nestable}(react.Component);Nestable.defaultProps={childrenProp:"children",confirmChange:function confirmChange(){return!0},items:[],onChange:function onChange(){},renderItem:function renderItem(_ref2){return _ref2.item.toString()}};var src_Nestable=Nestable;try{Nestable.displayName="Nestable",Nestable.__docgenInfo={description:"",displayName:"Nestable",props:{items:{defaultValue:{value:"[]"},description:"",name:"items",required:!1,type:{name:"any"}},childrenProp:{defaultValue:{value:"children"},description:"",name:"childrenProp",required:!1,type:{name:"any"}},renderItem:{defaultValue:{value:"({ item }: { item: any }) => item.toString()"},description:"",name:"renderItem",required:!1,type:{name:"(...args: any[]) => any"}},onChange:{defaultValue:{value:"() => {\n      return;\n    }"},description:"",name:"onChange",required:!1,type:{name:"any"}},confirmChange:{defaultValue:{value:"() => true"},description:"",name:"confirmChange",required:!1,type:{name:"any"}},childrenWrapperClassName:{defaultValue:null,description:"",name:"childrenWrapperClassName",required:!1,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/Dnd/src/Nestable.tsx#Nestable"]={docgenInfo:Nestable.__docgenInfo,name:"Nestable",path:"packages/Dnd/src/Nestable.tsx#Nestable"})}catch(__react_docgen_typescript_loader_error){}var fakeData=[{type:"row",settings:{name:"row-1",modifier:null,width:"full-width",backgroundImage:null,desktop:!0,tablet:!0,mobile:!0,gtmClassName:null},items:[{type:"video",settings:{name:"video 1",modifier:null,elementTitle:"video",url:"https://youtu.be/ZY3J3Y_OU0w",autoplay:!1,gtmClassName:null},id:"video 1",name:"video-1",items:null},{type:"card",settings:{name:"card-1",modifier:"",elementTitle:"Card",entity:"page",limit:1,itemsPerRow:1,sortby:"name",sort:"ASC",filterByProperty:"",filterByFeatured:!1,style:"portrait",propsToDisplay:[],hasBanner:!1,gtmClassName:""},id:"244446a0-20c2-11ea-8323-dffe12b3279d",name:"card-1",items:null}],name:"row 1"}],stories_DemoComponent=function DemoComponent(){return react.createElement("div",{className:"component-wrapper"},react.createElement("h1",null,"Dnd"),react.createElement(src_Nestable,{items:fakeData,childrenProp:"items",onChange:function handleOrder(params){},renderItem:function renderItem(_ref){var item=_ref.item,DragHandler=_ref.DragHandler,children=_ref.children;return react.createElement("div",{style:{padding:"20px",border:"1px solid #F0F0F0",backgroundColor:"#FFFFFF",display:"flex"}},react.createElement(DragHandler,null),react.createElement("p",null,item.name),children)}}))}},7145:function(module,exports){"use strict";function stringifiable(obj){return"object"!=typeof obj||"toString"in obj?obj:Object.prototype.toString.call(obj).slice(8,-1)}Object.defineProperty(exports,"__esModule",{value:!0});var isProduction="object"==typeof process&&!0;function invariant(condition,message){if(!condition){if(isProduction)throw new Error("Invariant failed");throw new Error(message())}}exports.invariant=invariant;var hasOwnProperty=Object.prototype.hasOwnProperty,splice=Array.prototype.splice,toString=Object.prototype.toString;function type(obj){return toString.call(obj).slice(8,-1)}var assign=Object.assign||function(target,source){return getAllKeys(source).forEach((function(key){hasOwnProperty.call(source,key)&&(target[key]=source[key])})),target},getAllKeys="function"==typeof Object.getOwnPropertySymbols?function(obj){return Object.keys(obj).concat(Object.getOwnPropertySymbols(obj))}:function(obj){return Object.keys(obj)};function copy(object){return Array.isArray(object)?assign(object.constructor(object.length),object):"Map"===type(object)?new Map(object):"Set"===type(object)?new Set(object):object&&"object"==typeof object?assign(Object.create(Object.getPrototypeOf(object)),object):object}var Context=function(){function Context(){this.commands=assign({},defaultCommands),this.update=this.update.bind(this),this.update.extend=this.extend=this.extend.bind(this),this.update.isEquals=function(x,y){return x===y},this.update.newContext=function(){return(new Context).update}}return Object.defineProperty(Context.prototype,"isEquals",{get:function(){return this.update.isEquals},set:function(value){this.update.isEquals=value},enumerable:!0,configurable:!0}),Context.prototype.extend=function(directive,fn){this.commands[directive]=fn},Context.prototype.update=function(object,$spec){var _this=this,spec="function"==typeof $spec?{$apply:$spec}:$spec;Array.isArray(object)&&Array.isArray(spec)||invariant(!Array.isArray(spec),(function(){return"update(): You provided an invalid spec to update(). The spec may not contain an array except as the value of $set, $push, $unshift, $splice or any custom command allowing an array value."})),invariant("object"==typeof spec&&null!==spec,(function(){return"update(): You provided an invalid spec to update(). The spec and every included key path must be plain objects containing one of the following commands: "+Object.keys(_this.commands).join(", ")+"."}));var nextObject=object;return getAllKeys(spec).forEach((function(key){if(hasOwnProperty.call(_this.commands,key)){var objectWasNextObject=object===nextObject;nextObject=_this.commands[key](spec[key],nextObject,spec,object),objectWasNextObject&&_this.isEquals(nextObject,object)&&(nextObject=object)}else{var nextValueForKey="Map"===type(object)?_this.update(object.get(key),spec[key]):_this.update(object[key],spec[key]),nextObjectValue="Map"===type(nextObject)?nextObject.get(key):nextObject[key];_this.isEquals(nextValueForKey,nextObjectValue)&&(void 0!==nextValueForKey||hasOwnProperty.call(object,key))||(nextObject===object&&(nextObject=copy(object)),"Map"===type(nextObject)?nextObject.set(key,nextValueForKey):nextObject[key]=nextValueForKey)}})),nextObject},Context}();exports.Context=Context;var defaultCommands={$push:function(value,nextObject,spec){return invariantPushAndUnshift(nextObject,spec,"$push"),value.length?nextObject.concat(value):nextObject},$unshift:function(value,nextObject,spec){return invariantPushAndUnshift(nextObject,spec,"$unshift"),value.length?value.concat(nextObject):nextObject},$splice:function(value,nextObject,spec,originalObject){return function invariantSplices(value,spec){invariant(Array.isArray(value),(function(){return"Expected $splice target to be an array; got "+stringifiable(value)})),invariantSplice(spec.$splice)}(nextObject,spec),value.forEach((function(args){invariantSplice(args),nextObject===originalObject&&args.length&&(nextObject=copy(originalObject)),splice.apply(nextObject,args)})),nextObject},$set:function(value,_nextObject,spec){return function invariantSet(spec){invariant(1===Object.keys(spec).length,(function(){return"Cannot have more than one key in an object with $set"}))}(spec),value},$toggle:function(targets,nextObject){invariantSpecArray(targets,"$toggle");var nextObjectCopy=targets.length?copy(nextObject):nextObject;return targets.forEach((function(target){nextObjectCopy[target]=!nextObject[target]})),nextObjectCopy},$unset:function(value,nextObject,_spec,originalObject){return invariantSpecArray(value,"$unset"),value.forEach((function(key){Object.hasOwnProperty.call(nextObject,key)&&(nextObject===originalObject&&(nextObject=copy(originalObject)),delete nextObject[key])})),nextObject},$add:function(values,nextObject,_spec,originalObject){return invariantMapOrSet(nextObject,"$add"),invariantSpecArray(values,"$add"),"Map"===type(nextObject)?values.forEach((function(_a){var key=_a[0],value=_a[1];nextObject===originalObject&&nextObject.get(key)!==value&&(nextObject=copy(originalObject)),nextObject.set(key,value)})):values.forEach((function(value){nextObject!==originalObject||nextObject.has(value)||(nextObject=copy(originalObject)),nextObject.add(value)})),nextObject},$remove:function(value,nextObject,_spec,originalObject){return invariantMapOrSet(nextObject,"$remove"),invariantSpecArray(value,"$remove"),value.forEach((function(key){nextObject===originalObject&&nextObject.has(key)&&(nextObject=copy(originalObject)),nextObject.delete(key)})),nextObject},$merge:function(value,nextObject,_spec,originalObject){return function invariantMerge(target,specValue){invariant(specValue&&"object"==typeof specValue,(function(){return"update(): $merge expects a spec of type 'object'; got "+stringifiable(specValue)})),invariant(target&&"object"==typeof target,(function(){return"update(): $merge expects a target of type 'object'; got "+stringifiable(target)}))}(nextObject,value),getAllKeys(value).forEach((function(key){value[key]!==nextObject[key]&&(nextObject===originalObject&&(nextObject=copy(originalObject)),nextObject[key]=value[key])})),nextObject},$apply:function(value,original){return function invariantApply(fn){invariant("function"==typeof fn,(function(){return"update(): expected spec of $apply to be a function; got "+stringifiable(fn)+"."}))}(value),value(original)}},defaultContext=new Context;function invariantPushAndUnshift(value,spec,command){invariant(Array.isArray(value),(function(){return"update(): expected target of "+stringifiable(command)+" to be an array; got "+stringifiable(value)+"."})),invariantSpecArray(spec[command],command)}function invariantSpecArray(spec,command){invariant(Array.isArray(spec),(function(){return"update(): expected spec of "+stringifiable(command)+" to be an array; got "+stringifiable(spec)+". Did you forget to wrap your parameter in an array?"}))}function invariantSplice(value){invariant(Array.isArray(value),(function(){return"update(): expected spec of $splice to be an array of arrays; got "+stringifiable(value)+". Did you forget to wrap your parameters in an array?"}))}function invariantMapOrSet(target,command){var typeOfTarget=type(target);invariant("Map"===typeOfTarget||"Set"===typeOfTarget,(function(){return"update(): "+stringifiable(command)+" expects a target of type Set or Map; got "+stringifiable(typeOfTarget)}))}exports.isEquals=defaultContext.update.isEquals,exports.extend=defaultContext.extend,exports.default=defaultContext.update,exports.default.default=module.exports=assign(exports.default,exports)},1775:function(module){"use strict";var hasOwnProperty=Object.prototype.hasOwnProperty;function is(x,y){return x===y?0!==x||0!==y||1/x==1/y:x!=x&&y!=y}function shallowEqual(objA,objB){if(is(objA,objB))return!0;if("object"!=typeof objA||null===objA||"object"!=typeof objB||null===objB)return!1;var keysA=Object.keys(objA),keysB=Object.keys(objB);if(keysA.length!==keysB.length)return!1;for(var i=0;i<keysA.length;i++)if(!hasOwnProperty.call(objB,keysA[i])||!is(objA[keysA[i]],objB[keysA[i]]))return!1;return!0}module.exports=function shallowCompare(instance,nextProps,nextState){return!shallowEqual(instance.props,nextProps)||!shallowEqual(instance.state,nextState)}}}]);
//# sourceMappingURL=518.348ab74a.iframe.bundle.js.map