(self.webpackChunkblaze_react=self.webpackChunkblaze_react||[]).push([[650],{74650:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:function(){return src_FileUpload}});var toConsumableArray=__webpack_require__(85061),asyncToGenerator=__webpack_require__(92137),slicedToArray=__webpack_require__(28481),lodash_clonedeep=(__webpack_require__(82526),__webpack_require__(26833),__webpack_require__(88674),__webpack_require__(41539),__webpack_require__(78783),__webpack_require__(66992),__webpack_require__(33948),__webpack_require__(21249),__webpack_require__(26699),__webpack_require__(32023),__webpack_require__(19601),__webpack_require__(68309),__webpack_require__(92222),__webpack_require__(57327),__webpack_require__(9653),__webpack_require__(23123),__webpack_require__(74916),__webpack_require__(83465)),lodash_clonedeep_default=__webpack_require__.n(lodash_clonedeep),react=__webpack_require__(67294),index_prod=__webpack_require__(18917),src=__webpack_require__(99410),Actions=function Actions(_ref){var handleBrowse=_ref.handleBrowse,handleLibraryClick=_ref.handleLibraryClick,handleChange=_ref.handleChange,selectFile=_ref.selectFile,actionText=_ref.actionText;return react.createElement(react.Fragment,null,!handleLibraryClick&&react.createElement(src.Z,{onClick:handleBrowse},"Browse"),handleLibraryClick&&react.createElement(src.Z,{onClick:handleLibraryClick},actionText),react.createElement("input",{type:"file",onChange:handleChange,ref:selectFile,style:{display:"none"}}))},src_Actions=Actions;try{Actions.displayName="Actions",Actions.__docgenInfo={description:"",displayName:"Actions",props:{handleLibraryClick:{defaultValue:null,description:"",name:"handleLibraryClick",required:!1,type:{name:"(...args: any[]) => void"}},handleBrowse:{defaultValue:null,description:"",name:"handleBrowse",required:!1,type:{name:"(...args: any[]) => void"}},handleChange:{defaultValue:null,description:"",name:"handleChange",required:!1,type:{name:"(...args: any[]) => void"}},selectFile:{defaultValue:null,description:"",name:"selectFile",required:!0,type:{name:"any"}},actionText:{defaultValue:null,description:"",name:"actionText",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/FileUpload/src/Actions/index.tsx#Actions"]={docgenInfo:Actions.__docgenInfo,name:"Actions",path:"packages/FileUpload/src/Actions/index.tsx#Actions"})}catch(__react_docgen_typescript_loader_error){}var DATA_ATTRIBUTS={altText:"",caption:"",hrefUrl:""},INPUT_TYPES_ALT_TEXT="altText",INPUT_TYPES_CAPTION="caption",INPUT_TYPES_TITLE="title",INPUT_TYPES_HREF_URL="hrefUrl",src_DocumentIcon=function DocumentIcon(){return react.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100",height:"100",viewBox:"0 0 8 8"},react.createElement("path",{d:"M0 0v8h7v-4h-4v-4h-3zm4 0v3h3l-3-3zm-3 2h1v1h-1v-1zm0 2h1v1h-1v-1zm0 2h4v1h-4v-1z"}))},Input_src=__webpack_require__(66602),Select_src=__webpack_require__(83354),get_input_label=function getInputLabel(input,type){switch(type){case"image":return"image "+input;case"doc":return"document "+input;default:return"video "+input}},sanitized_filename=(__webpack_require__(15306),function sanitizedFilename(file){return file.name&&file.name.replace(".","")});try{sanitizedfilename.displayName="sanitizedfilename",sanitizedfilename.__docgenInfo={description:"",displayName:"sanitizedfilename",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/FileUpload/src/utils/sanitized-filename.tsx#sanitizedfilename"]={docgenInfo:sanitizedfilename.__docgenInfo,name:"sanitizedfilename",path:"packages/FileUpload/src/utils/sanitized-filename.tsx#sanitizedfilename"})}catch(__react_docgen_typescript_loader_error){}var ALT_TEXT=INPUT_TYPES_ALT_TEXT,CAPTION=INPUT_TYPES_CAPTION,HREF_URL=INPUT_TYPES_HREF_URL,TITLE=INPUT_TYPES_TITLE,FileInputs=function FileInputs(_ref){var data=_ref.data,file=_ref.file,handleInputChange=_ref.handleInputChange,handleSelectChange=_ref.handleSelectChange,index=_ref.index,name=_ref.name,selectOptions=_ref.selectOptions;return react.createElement(react.Fragment,null,react.createElement(Input_src.Z,{label:get_input_label(TITLE,file.type),onChange:handleInputChange,value:name,id:index+"-title-"+sanitized_filename(file),name:"name"}),react.createElement(Input_src.Z,{label:get_input_label(CAPTION,file.type),onChange:handleInputChange,value:data.caption,id:index+"-caption-"+sanitized_filename(file),name:CAPTION+"-"+index+"-"+sanitized_filename(file)}),"image"===file.type&&react.createElement(react.Fragment,null,react.createElement(Input_src.Z,{label:"Alternative text",onChange:handleInputChange,value:data.altText,id:index+"-altText-"+sanitized_filename(file),name:ALT_TEXT+"-"+index+"-"+sanitized_filename(file)}),react.createElement(Input_src.Z,{label:"Url",onChange:handleInputChange,value:data.urlRedirect,id:index+"-hrefUrl-"+sanitized_filename(file),name:HREF_URL+"-"+index+"-"+sanitized_filename(file)}),react.createElement(Select_src.Z,{label:"Store type","data-testid":"store-type",options:selectOptions,onChange:function onChange(event){return handleSelectChange(event,index)}})))},src_FileInputs=FileInputs;try{FileInputs.displayName="FileInputs",FileInputs.__docgenInfo={description:"",displayName:"FileInputs",props:{data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"any"}},file:{defaultValue:null,description:"",name:"file",required:!0,type:{name:"any"}},handleInputChange:{defaultValue:null,description:"",name:"handleInputChange",required:!0,type:{name:"any"}},handleSelectChange:{defaultValue:null,description:"",name:"handleSelectChange",required:!0,type:{name:"any"}},index:{defaultValue:null,description:"",name:"index",required:!0,type:{name:"any"}},name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},selectOptions:{defaultValue:null,description:"",name:"selectOptions",required:!0,type:{name:"any[]"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/FileUpload/src/FileInputs/index.tsx#FileInputs"]={docgenInfo:FileInputs.__docgenInfo,name:"FileInputs",path:"packages/FileUpload/src/FileInputs/index.tsx#FileInputs"})}catch(__react_docgen_typescript_loader_error){}var FileList=function FileList(_ref){var previewImages=_ref.previewImages,handleCancel=_ref.handleCancel,handleInputChange=_ref.handleInputChange,handleSelectChange=_ref.handleSelectChange,selectOptions=_ref.selectOptions;return react.createElement(react.Fragment,null,previewImages.map((function(_ref2,index){var file=_ref2.file,name=_ref2.name,fileInputsProps={data:_ref2.data,file:file,handleInputChange:handleInputChange,handleSelectChange:handleSelectChange,index:index,name:name,selectOptions:selectOptions},isImage="image"===file.type;return react.createElement(react.Fragment,{key:file.id},react.createElement("div",{className:"preview"},react.createElement("div",{className:"preview__file preview__file--"+file.type},isImage?react.createElement("img",{src:file.base64}):react.createElement(src_DocumentIcon,null)),react.createElement("div",{className:"preview__details"},react.createElement("div",{className:"preview__filename"},file.name),react.createElement("div",{className:"preview__form"},(isImage||"doc"===file.type)&&react.createElement(src_FileInputs,Object.assign({},fileInputsProps)),react.createElement("i",{onClick:function onClick(){return handleCancel(file.id)},className:"material-icons","aria-hidden":"true","data-testid":"delete"},"delete_outline")))))})))},src_FileList=FileList;try{FileList.displayName="FileList",FileList.__docgenInfo={description:"",displayName:"FileList",props:{previewImages:{defaultValue:null,description:"",name:"previewImages",required:!0,type:{name:"any"}},handleCancel:{defaultValue:null,description:"",name:"handleCancel",required:!0,type:{name:"any"}},handleInputChange:{defaultValue:null,description:"",name:"handleInputChange",required:!0,type:{name:"any"}},handleSelectChange:{defaultValue:null,description:"",name:"handleSelectChange",required:!0,type:{name:"any"}},selectOptions:{defaultValue:null,description:"",name:"selectOptions",required:!0,type:{name:"any[]"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/FileUpload/src/FileList/index.tsx#FileList"]={docgenInfo:FileList.__docgenInfo,name:"FileList",path:"packages/FileUpload/src/FileList/index.tsx#FileList"})}catch(__react_docgen_typescript_loader_error){}var __rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t},DraggableFileUpload=function DraggableFileUpload(_a){var handleCancel=_a.handleCancel,area=_a.area,customPreview=_a.customPreview,previewImages=_a.previewImages,handleInputChange=_a.handleInputChange,handleSelectChange=_a.handleSelectChange,children=_a.children,selectOptions=_a.selectOptions,attrs=__rest(_a,["handleCancel","area","customPreview","previewImages","handleInputChange","handleSelectChange","children","selectOptions"]),_useState=(0,react.useState)(previewImages),_useState2=(0,slicedToArray.Z)(_useState,2),imagesToPreview=_useState2[0],setImagesToPreview=_useState2[1];return(0,react.useEffect)((function(){return setImagesToPreview(previewImages)}),[previewImages]),react.createElement("div",Object.assign({ref:area,className:"upload"},attrs),react.createElement("div",{className:"upload__drag-drop"},react.createElement("div",{className:"upload__icon"},react.createElement("i",{className:"material-icons"},"arrow_upward")),react.createElement("p",null,"Drag & drop file to upload")),react.createElement("div",{className:"upload__browse"},react.createElement("div",{className:"upload__text"},"or"),children),!customPreview&&react.createElement(src_FileList,{previewImages:imagesToPreview,handleCancel:handleCancel,handleInputChange:handleInputChange,handleSelectChange:handleSelectChange,selectOptions:selectOptions}))},src_DraggableFileUpload=DraggableFileUpload;try{DraggableFileUpload.displayName="DraggableFileUpload",DraggableFileUpload.__docgenInfo={description:"",displayName:"DraggableFileUpload",props:{handleLibraryClick:{defaultValue:null,description:"",name:"handleLibraryClick",required:!1,type:{name:"(...args: any[]) => void"}},handleBrowse:{defaultValue:null,description:"",name:"handleBrowse",required:!1,type:{name:"(...args: any[]) => void"}},handleCancel:{defaultValue:null,description:"",name:"handleCancel",required:!1,type:{name:"(...args: any[]) => void"}},handleInputChange:{defaultValue:null,description:"",name:"handleInputChange",required:!1,type:{name:"(...args: any[]) => void"}},handleSelectChange:{defaultValue:null,description:"",name:"handleSelectChange",required:!1,type:{name:"(...args: any[]) => void"}},area:{defaultValue:null,description:"",name:"area",required:!0,type:{name:"any"}},customPreview:{defaultValue:null,description:"",name:"customPreview",required:!1,type:{name:"boolean"}},previewImages:{defaultValue:null,description:"",name:"previewImages",required:!0,type:{name:"Record<string, unknown>[]"}},selectOptions:{defaultValue:null,description:"",name:"selectOptions",required:!0,type:{name:"any[]"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/FileUpload/src/DraggableFileUpload/index.tsx#DraggableFileUpload"]={docgenInfo:DraggableFileUpload.__docgenInfo,name:"DraggableFileUpload",path:"packages/FileUpload/src/DraggableFileUpload/index.tsx#DraggableFileUpload"})}catch(__react_docgen_typescript_loader_error){}var FileUpload_rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t},FileUpload=function FileUpload(_a){var onChange=_a.onChange,handleDropProp=_a.handleDrop,customPreview=_a.customPreview,handleLibraryClick=_a.handleLibraryClick,enableDragAndDrop=_a.enableDragAndDrop,actionText=_a.actionText,selectOptions=_a.selectOptions,attr=FileUpload_rest(_a,["onChange","handleDrop","customPreview","handleLibraryClick","enableDragAndDrop","actionText","selectOptions"]),_useState=(0,react.useState)([]),_useState2=(0,slicedToArray.Z)(_useState,2),previewImages=_useState2[0],setPreviewImages=_useState2[1],_useState3=(0,react.useState)([]),_useState4=(0,slicedToArray.Z)(_useState3,2),filesToUpload=_useState4[0],setFilesToUpload=_useState4[1],area=(0,react.useRef)(null),selectFile=(0,react.useRef)(null),handleDragover=function handleDragover(event){event.stopPropagation(),event.preventDefault()};(0,react.useEffect)((function(){var handler=setTimeout((function(){onChange(filesToUpload)}),500);return function(){clearTimeout(handler)}}),[filesToUpload]),(0,react.useEffect)((function(){var handleDrop=function handleDrop(event){event.preventDefault(),event.stopPropagation();var _event$dataTransfer=event.dataTransfer,_event$dataTransfer$f=(_event$dataTransfer=void 0===_event$dataTransfer?{}:_event$dataTransfer).files,files=void 0===_event$dataTransfer$f?{}:_event$dataTransfer$f;files=Object.values(files),processFiles(files),onChange(files)},currentArea=area.current;if(enableDragAndDrop)return currentArea.addEventListener("dragover",handleDragover),currentArea.addEventListener("drop",handleDrop),function(){currentArea.removeEventListener("dragover",handleDragover),currentArea.removeEventListener("drop",handleDrop)}}),[previewImages,filesToUpload]);var getPreview=function getPreview(files){return Promise.all(files.map((function(file){return new Promise((function(resolve,reject){if(file.type&&file.type.includes("image")){var reader=new FileReader;reader.readAsDataURL(file),reader.onload=function(e){return resolve({data:Object.assign({},DATA_ATTRIBUTS),file:{base64:e.target.result,id:file.id,name:file.name,type:"image"},name:""})},reader.onerror=function(){return reject(new DOMException("Error parsing input file."))}}else file.type&&file.type.includes("video")?resolve({file:{id:file.id,name:file.name,type:"video"},name:""}):resolve({data:Object.assign({},DATA_ATTRIBUTS),file:{id:file.id,name:file.name,type:"doc"},name:""})}))})))},processFiles=function(){var _ref=(0,asyncToGenerator.Z)(regeneratorRuntime.mark((function _callee(files){var previewFiles,formatFiles;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(files&&files.length){_context.next=2;break}return _context.abrupt("return");case 2:return files=files.map((function(file){try{file.id=(0,index_prod.x0)()}catch(e){return file}return file})),_context.next=5,getPreview(files);case 5:previewFiles=_context.sent,formatFiles=files.map((function(file){return{data:Object.assign({},DATA_ATTRIBUTS),file:file}})),setFilesToUpload([].concat((0,toConsumableArray.Z)(filesToUpload),(0,toConsumableArray.Z)(formatFiles))),setPreviewImages([].concat((0,toConsumableArray.Z)(previewImages),(0,toConsumableArray.Z)(previewFiles))),handleDropProp&&handleDropProp({previewFiles:[].concat((0,toConsumableArray.Z)(previewImages),(0,toConsumableArray.Z)(previewFiles))});case 10:case"end":return _context.stop()}}),_callee)})));return function processFiles(_x){return _ref.apply(this,arguments)}}(),handleChange=function handleChange(event){event.preventDefault();var _event$target=event.target,_event$target$files=(_event$target=void 0===_event$target?{}:_event$target).files,files=void 0===_event$target$files?{}:_event$target$files;files=Object.values(files),processFiles(files),onChange(files)},handleBrowse=function handleBrowse(){selectFile.current.click()},handleCancel=function handleCancel(idToRemove){var validFiles=function validFiles(files){return files.filter((function(_ref2){return _ref2.file.id!==idToRemove}))},fileToUploadUpdated=validFiles(filesToUpload),previewImagesUpdated=validFiles(previewImages);setFilesToUpload(fileToUploadUpdated),setPreviewImages(previewImagesUpdated),onChange(fileToUploadUpdated),handleDropProp&&handleDropProp({previewFiles:previewImagesUpdated})},handleInputChange=function handleInputChange(_ref3){var _event$target2=_ref3.event.target,id=_event$target2.id,name=_event$target2.name,value=_event$target2.value,filesToUploadCopy=lodash_clonedeep_default()(filesToUpload),previewImagesCopy=lodash_clonedeep_default()(previewImages),index=Number(id.split("-")[0]);if("name"!==name){var _name=name.split("-")[0];filesToUploadCopy[index].data[_name]=value,previewImagesCopy[index].data[_name]=value}else filesToUploadCopy[index][name]=value,previewImagesCopy[index][name]=value;setFilesToUpload(filesToUploadCopy),setPreviewImages(previewImagesCopy)},handleSelectChange=function handleSelectChange(_ref4,index){var value=_ref4.event.target.value,filesToUploadCopy=lodash_clonedeep_default()(filesToUpload);filesToUploadCopy[index].storeKey=value,setFilesToUpload(filesToUploadCopy)};return react.createElement(react.Fragment,null,enableDragAndDrop?react.createElement(src_DraggableFileUpload,Object.assign({previewImages:previewImages,handleCancel:handleCancel,customPreview:customPreview,area:area,handleInputChange:handleInputChange,handleSelectChange:handleSelectChange,selectOptions:selectOptions},attr),react.createElement(src_Actions,{actionText:actionText,handleLibraryClick:handleLibraryClick,handleBrowse:handleBrowse,handleChange:handleChange,selectFile:selectFile})):react.createElement(react.Fragment,null,react.createElement(src_Actions,{actionText:actionText,handleLibraryClick:handleLibraryClick,handleBrowse:handleBrowse,handleChange:handleChange,selectFile:selectFile}),!customPreview&&react.createElement(src_FileList,{previewImages:previewImages,handleCancel:handleCancel,handleInputChange:handleInputChange,handleSelectChange:handleSelectChange,selectOptions:selectOptions})))};FileUpload.defaultProps={actionText:"Add Files",children:"No content",customPreview:!1,enableDragAndDrop:!0,handleDrop:function handleDrop(){},onChange:function onChange(){}};var src_FileUpload=FileUpload}}]);
//# sourceMappingURL=650.2975b7cd.iframe.bundle.js.map